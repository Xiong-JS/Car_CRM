<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../layui/css/layui.css" />
</head>

<body style="padding: 10px;">
        <form class="layui-form" lay-filter='formUpdateReason' action="">
        <div class="layui-form-item" id="lostReason">
                    <label class="layui-form-label">流失原因</label>
                    <div class="layui-input-block">
                      <textarea name="lostReason"  class="layui-textarea"  lay-verify="required" placeholder="请输入流失原因"></textarea>
                    </div>
               </div>
        
        <div class="layui-form-item" id="comment">
                    <label class="layui-form-label">备注</label>
                    <div class="layui-input-block">
                      <textarea name="comment"  class="layui-textarea" placeholder="请输入备注"></textarea>
                    </div>
            </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button type="submit" class="layui-btn" lay-submit="" lay-filter="btnSubmitUpdate">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>

    <script src="../layui/layui.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
        layui.use(['form', 'jquery'], function () {
            var form = layui.form
            var $ = layui.jquery
            form.render()
            form.val('formUpdateReason', {
                "lostReason":parent.row.lostReason,
                "comment":parent.row.comment
            })

            	//表单提交事件
			form.on('submit(btnSubmitUpdate)',function(data){
				$.ajax({
					url:'http://localhost:8080/customer/updateCustomer',
					type:'POST',
					dataType:'JSON',
					data:data.field,
					success:function(obj){
						//后台成功修改后的操作
						var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
						parent.layer.close(index); //再执行关闭   
						parent.table.reload('tabWarn');
					}
				})
				return false;
			})

        })

    </script>
</body>

</html>